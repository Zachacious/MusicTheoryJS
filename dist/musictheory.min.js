!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).MusicTheory={})}(this,function(e){"use strict";const i=(e,t,n)=>{let r=e,o=t,s=n;n<t&&(o=n,s=t);t=0-o;o+=t,s+=t,r+=t;let a=Math.trunc(r/s);0===a&&r<o&&(a=-1),1===a&&r===s&&(a=0);let i=0,c=0;return-1<=a&&a<=1&&(c=1),r<o?(i=r%s+c,r=s+i):r>s&&(i=r%s-c,r=o+i),r-=t,{value:r,numWraps:a}},c=(e,t,n)=>Math.max(Math.min(e,Math.max(t,n)),Math.min(t,n)),f=11,u=0,l=9,m=0,r=4,o=0;var t;(a=t=t||{})[a.A=9]="A",a[a.As=10]="As",a[a.Bb=10]="Bb",a[a.B=11]="B",a[a.Bs=0]="Bs",a[a.Cb=11]="Cb",a[a.C=0]="C",a[a.Cs=1]="Cs",a[a.Db=1]="Db",a[a.D=2]="D",a[a.Ds=3]="Ds",a[a.Eb=3]="Eb",a[a.E=4]="E",a[a.Es=5]="Es",a[a.Fb=4]="Fb",a[a.F=5]="F",a[a.Fs=6]="Fs",a[a.Gb=6]="Gb",a[a.G=7]="G",a[a.Gs=8]="Gs",a[a.Ab=8]="Ab";const v=e=>{if(!e||0===e.length||1<e.length)throw new Error("Invalid name");e=e[0].toUpperCase();return t[e]};var n,s=t;(a=n=n||{})[a.FLAT=-1]="FLAT",a[a.NATURAL=0]="NATURAL",a[a.SHARP=1]="SHARP";const b=e=>{switch(e){case"b":case"flat":return n.FLAT;case"#":case"s":case"sharp":return n.SHARP;default:return n.NATURAL}};var a=n;const h=/([A-G])/g,p=/(#|s|b)/g,g=/([0-9]*)/g,A=(t,n=!1)=>{try{var r=d[t];if(r)return r;n||console.warn(`Ineffecient note string formatting - ${t}. Get a performanc increase by using the format [A-G][#|s|b][0-9]`)}catch(e){n||console.warn(`Ineffecient note string formatting - ${t}. Get a performanc increase by using the format [A-G][#|s|b][0-9]`)}let o=0,s="";r=t.match(h)?.join("").split("");const e=t.match(p)?.join("").split("");n=t.match(g)?.join("").split("");if(e&&(o=1<e.length?e.reduce((e,t)=>{return(e="string"==typeof e?b(e):e)+b(t)}):b(e[0])),n&&([n]=n,s=n),r){var[r]=r,a=r;let e=0;o&&(e=o);a=i(v(a)+e,u,f).value;let t=4;return s&&(t=c(parseInt(s),m,l)),{semitone:a,octave:t}}throw new Error("Invalid note: "+t)};const d=(()=>{const n={};var r=["b","#","s"];for(const s of["A","B","C","D","E","F","G"]){n[s]=A(s,!0);for(let e=0;e<r.length;++e){var t=""+s+r[e];n[t]=A(t,!0)}for(let t=m;t<l;++t){var e=""+s+t;n[e]=A(e,!0);for(let e=0;e<r.length;++e){var o=""+s+r[e]+t;n[o]=A(o,!0)}}}return n})();for(var G,y=256,_=[],F=256;y--;)_[y]=(y+256).toString(16).substring(1);const E=e=>({id:function(e){var t=0,e=e||11;if(!G||2*F<y+e)for(G="",y=0;t<F;t++)G+=_[256*Math.random()|0];return G.substring(y,y+++e)}()});e.Modifier=a,e.Note=e=>{var t={octave:()=>0},t=(t=[t,E(),(t=>{const n={_octave:r,octave:()=>null};return n.octave=e=>e?(n._octave=c(e,m,l),t):n._octave,n})(t),(t=>{const n={_semitone:o,_prevSemitone:o,semitone:()=>null};return n.semitone=e=>{if(e){e=i(e,u,f);return n._prevSemitone=n._semitone,n._semitone=e.value,t.octave(t.octave()+e.numWraps),t}return n._semitone},n})(t)],Object.assign({},...t));return e&&"string"==typeof e&&(e=A(e)),t},e.Semitone=s,e.wrap=i,Object.defineProperty(e,"__esModule",{value:!0})});
