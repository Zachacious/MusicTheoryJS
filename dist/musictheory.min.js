!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).MusicTheory={})}(this,function(e){"use strict";for(var n,r=256,s=[],o=256;r--;)s[r]=(r+256).toString(16).substring(1);var t;(A=t=t||{})[A.A=9]="A",A[A.As=10]="As",A[A.Bb=10]="Bb",A[A.B=11]="B",A[A.Bs=0]="Bs",A[A.Cb=11]="Cb",A[A.C=0]="C",A[A.Cs=1]="Cs",A[A.Db=1]="Db",A[A.D=2]="D",A[A.Ds=3]="Ds",A[A.Eb=3]="Eb",A[A.E=4]="E",A[A.Es=5]="Es",A[A.Fb=4]="Fb",A[A.F=5]="F",A[A.Fs=6]="Fs",A[A.Gb=6]="Gb",A[A.G=7]="G",A[A.Gs=8]="Gs",A[A.Ab=8]="Ab";const a=e=>{if(!e||0===e.length||2<e.length)throw new Error("Invalid name");e=e[0].toUpperCase();return t[e]};var i,c=t;const u=(e,t,n)=>{let r=t,s=n;n<t&&(r=n,s=t);let o=e;e=0-r;r+=e,s+=e,o+=e;let i=Math.trunc(o/s);0===i&&o<r&&(i=-1);let a=0,c=0;return-1<=i&&i<=1&&(c=1),o<r?(a=o%s+c,o=s+a):o>s&&(a=o%s-c,o=r+a),o-=e,{value:o,numWraps:i}},h=(e,t,n)=>Math.max(Math.min(e,Math.max(t,n)),Math.min(t,n)),l=[1,3,4,6,8,10],v=11,f=0,m=9,p=0;(S=i=i||{})[S.FLAT=-1]="FLAT",S[S.NATURAL=0]="NATURAL",S[S.SHARP=1]="SHARP";const b=e=>{switch(e){case"b":case"flat":return i.FLAT;case"#":case"s":case"sharp":return i.SHARP;default:return i.NATURAL}};var A=i;const d=/([A-G])/g,g=/(#|s|b)/g,_=/([0-9]*)/g,y=(t,n=!1)=>{try{var r=G[t];if(r)return r;n||console.warn(`Ineffecient note string formatting - ${t}. Get a performanc increase by using the format [A-G][#|s|b][0-9]`)}catch(e){n||console.warn(`Ineffecient note string formatting - ${t}. Get a performanc increase by using the format [A-G][#|s|b][0-9]`)}let s=0,o="";r=t.match(d)?.join("").split("");const e=t.match(g)?.join("").split("");n=t.match(_)?.join("").split("");if(e&&(s=1<e.length?e.reduce((e,t)=>{return(e="string"==typeof e?b(e):e)+b(t)}):b(e[0])),n&&([n]=n,o=n),r){var[r]=r,i=r;let e=0;s&&(e=s);i=u(a(i)+e,f,v).value;let t=4;return o&&(t=h(parseInt(o),p,m)),{semitone:i,octave:t}}throw new Error("Invalid note: "+t)};const G=(()=>{const n={};var r=["b","#","s"];for(const o of["A","B","C","D","E","F","G"]){n[o]=y(o,!0);for(let e=0;e<r.length;++e){var t=""+o+r[e];n[t]=y(t,!0)}for(let t=p;t<m;++t){var e=""+o+t;n[e]=y(e,!0);for(let e=0;e<r.length;++e){var s=""+o+r[e]+t;n[s]=y(s,!0)}}}return n})(),w=["B#/C","C#/Db","D","D#/Eb","E/Fb","E#/F","F#/Gb","G","G#/Ab","A","A#/Bb","B/Cb"],F=["B#","C#","D","D#","E","E#","F#","G","G#","A","A#","B"],D=["C","Db","D","Eb","Fb","F","Gb","G","Ab","A","Bb","Cb"];var E;const C=(()=>{const r={};for(let n=f;n<=v;++n)for(let t=f;t<=v;++t){let e="";l.includes(n)&&(e="-",u(n+1,f,v).value===t&&(e="b"),u(n-1,f,v).value===t&&(e="#")),r[n+"-"+t]=((e,t)=>{switch(t){case"-":return w[e];case"#":return F[e];case"b":return D[e];default:return`${c[e]}`}})(n,e)}return r})();let B=E=class{constructor(e){e?("string"==typeof e&&(e=y(e)),this.octave=e?.octave??4,this.semitone=e?.semitone??0,this._prevSemitone=this._tone):(this.octave=4,this.semitone=0)}_tone=0;_prevSemitone=0;get semitone(){return this._tone}set semitone(e){e=u(e,f,v);this._prevSemitone=this._tone,this._tone=e.value,this._octave=this._octave+e.numWraps}_octave=4;get octave(){return this._octave}set octave(e){this._octave=h(e,p,m)}sharp(){return new E({semitone:this.semitone+1,octave:this.octave})}sharpen(){return this.semitone=this.semitone+1,this}isSharp(){return!!l.includes(this.semitone)&&u(this.semitone+1,f,v).value!==this._prevSemitone}flat(){return new E({semitone:this.semitone-1,octave:this.octave})}flatten(){return this.semitone=this.semitone-1,this}isFlat(){return!!l.includes(this.semitone)&&u(this.semitone-1,f,v).value!==this._prevSemitone}equals(e){return this.semitone===e.semitone&&this.octave===e.octave}copy(){return new E({semitone:this.semitone,octave:this.octave})}toString(){return C[this._tone+"-"+this._prevSemitone]+(""+this._octave)}static A(e=4){return new E({semitone:c.A,octave:e})}static B(e){return new E({semitone:c.B,octave:e})}static C(e){return new E({semitone:c.C,octave:e})}static D(e){return new E({semitone:c.D,octave:e})}static E(e){return new E({semitone:c.E,octave:e})}static F(e){return new E({semitone:c.F,octave:e})}static G(e){return new E({semitone:c.G,octave:e})}};B=E=function(e,t,n,r){var s,o=arguments.length,i=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;0<=a;a--)(s=e[a])&&(i=(o<3?s(i):3<o?s(t,n,i):s(t,n))||i);return 3<o&&i&&Object.defineProperty(t,n,i),i}([t=>{t.prototype.id=e=>(void 0===t.prototype._id&&(t.prototype._id=function(e){var t=0,e=e||11;if(!n||2*o<r+e)for(n="",r=0;t<o;t++)n+=s[256*Math.random()|0];return n.substring(r,r+++e)}()),e&&(t.prototype._id=e),t.prototype._id)}],B);var S=B;e.Modifier=A,e.Note=S,e.Semitone=c,e.wrap=u,Object.defineProperty(e,"__esModule",{value:!0})});
