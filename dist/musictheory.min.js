!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).MusicTheory={})}(this,function(e){"use strict";for(var n,o=256,s=[],r=256;o--;)s[o]=(o+256).toString(16).substring(1);var t;(_=t=t||{})[_.A=9]="A",_[_.As=10]="As",_[_.Bb=10]="Bb",_[_.B=11]="B",_[_.Bs=0]="Bs",_[_.Cb=11]="Cb",_[_.C=0]="C",_[_.Cs=1]="Cs",_[_.Db=1]="Db",_[_.D=2]="D",_[_.Ds=3]="Ds",_[_.Eb=3]="Eb",_[_.E=4]="E",_[_.Es=5]="Es",_[_.Fb=4]="Fb",_[_.F=5]="F",_[_.Fs=6]="Fs",_[_.Gb=6]="Gb",_[_.G=7]="G",_[_.Gs=8]="Gs",_[_.Ab=8]="Ab";const a=e=>{if(!e||0===e.length||2<e.length)throw new Error("Invalid name");e=e[0].toUpperCase();return t[e]};var i,c=t;const h=(e,t,n)=>{let o=t,s=n;n<t&&(o=n,s=t);let r=e;e=0-o;o+=e,s+=e,r+=e;let i=Math.trunc(r/s);0===i&&r<o&&(i=-1);let a=0,c=0;return-1<=i&&i<=1&&(c=1),r<o?(a=r%s+c,r=s+a):r>s&&(a=r%s-c,r=o+a),r-=e,{value:r,numWraps:i}},u=(e,t,n)=>Math.max(Math.min(e,Math.max(t,n)),Math.min(t,n)),l=[1,3,4,6,8,10],m=11,f=0,v=9,p=0;let b=i=class{constructor(e){this.octave=e?.octave??4,this.semitone=e?.semitone??0,this._prevSemitone=this._tone}_tone=0;_prevSemitone=0;get semitone(){return this._tone}set semitone(e){e=h(e,f,m);this._prevSemitone=this._tone,this._tone=e.value,this._octave=this._octave+e.numWraps}_octave=4;get octave(){return this._octave}set octave(e){this._octave=u(e,p,v)}sharp(){return new i({semitone:this.semitone+1,octave:this.octave})}sharpen(){return this.semitone=this.semitone+1,this}isSharp(){return!!l.includes(this.semitone)&&this.semitone+1!==this._prevSemitone}flat(){return new i({semitone:this.semitone-1,octave:this.octave})}flatten(){return this.semitone=this.semitone-1,this}isFlat(){return!!l.includes(this.semitone)&&this.semitone-1!==this._prevSemitone}equals(e){return this.semitone===e.semitone&&this.octave===e.octave}copy(){return new i({semitone:this.semitone,octave:this.octave})}static A(e=4){return new i({semitone:c.A,octave:e})}static B(e){return new i({semitone:c.B,octave:e})}static C(e){return new i({semitone:c.C,octave:e})}static D(e){return new i({semitone:c.D,octave:e})}static E(e){return new i({semitone:c.E,octave:e})}static F(e){return new i({semitone:c.F,octave:e})}static G(e){return new i({semitone:c.G,octave:e})}};b=i=function(e,t,n,o){var s,r=arguments.length,i=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;0<=a;a--)(s=e[a])&&(i=(r<3?s(i):3<r?s(t,n,i):s(t,n))||i);return 3<r&&i&&Object.defineProperty(t,n,i),i}([t=>{t.prototype.id=e=>(void 0===t.prototype._id&&(t.prototype._id=function(e){var t=0,e=e||11;if(!n||2*r<o+e)for(n="",o=0;t<r;t++)n+=s[256*Math.random()|0];return n.substring(o,o+++e)}()),e&&(t.prototype._id=e),t.prototype._id)}],b);var d,g=b;(_=d=d||{})[_.FLAT=-1]="FLAT",_[_.NATURAL=0]="NATURAL",_[_.SHARP=1]="SHARP";const A=e=>{switch(e){case"b":case"flat":return d.FLAT;case"#":case"s":case"sharp":return d.SHARP;default:return d.NATURAL}};var _=d;const y=/([A-G])/g,w=/(#|s|b)/g,G=/([0-9]*)/g,F=(t,n=!1)=>{try{var o=E[t];if(o)return o;n||console.warn(`Ineffecient note string formatting - ${t}. Get a performanc increase by using the format [A-G][#|s|b][0-9]`)}catch(e){n||console.warn(`Ineffecient note string formatting - ${t}. Get a performanc increase by using the format [A-G][#|s|b][0-9]`)}let s=0,r="";o=t.match(y)?.join("").split("");const e=t.match(w)?.join("").split("");n=t.match(G)?.join("").split("");if(e&&(s=1<e.length?e.reduce((e,t)=>{return(e="string"==typeof e?A(e):e)+A(t)}):A(e[0])),n&&([n]=n,r=n),o){var[o]=o,i=o;let e=0;s&&(e=s);i=h(a(i)+e,f,m).value;let t=4;return r&&(t=u(parseInt(r),p,v)),{semitone:i,octave:t}}throw new Error("Invalid note: "+t)};const E=(()=>{const n={};var o=["b","#","s"];for(const r of["A","B","C","D","E","F","G"]){n[r]=F(r,!0);for(let e=0;e<o.length;++e){var t=""+r+o[e];n[t]=F(t,!0)}for(let t=p;t<v;++t){var e=""+r+t;n[e]=F(e,!0);for(let e=0;e<o.length;++e){var s=""+r+o[e]+t;n[s]=F(s,!0)}}}return n})();console.log(E),e.Modifier=_,e.Note=g,e.Semitone=c,e.noteParser=F,e.wrap=h,Object.defineProperty(e,"__esModule",{value:!0})});
